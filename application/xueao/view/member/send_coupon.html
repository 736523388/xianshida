<link href="__STATIC__/plugs/awesome/css/font-awesome.min.css?v={:date('ymd')}" rel="stylesheet">
<link href="__STATIC__/plugs/bootstrap/css/bootstrap.min.css?v={:date('ymd')}" rel="stylesheet">
<link href="__STATIC__/plugs/layui/css/layui.css?v={:date('ymd')}" rel="stylesheet">
<link href="__STATIC__/theme/css/console.css?v={:date('ymd')}" rel="stylesheet">
<link href="__STATIC__/theme/css/animate.css?v={:date('ymd')}" rel="stylesheet">
{block name="style"}{/block}
<script>window.ROOT_URL = '__ROOT__';</script>
<script src="__STATIC__/plugs/jquery/pace.min.js"></script>
<script src="__STATIC__/plugs/layui/layui.all.js"></script>
<script src="__STATIC__/admin.js"></script>
<style>
    body{padding: 20px 30px;}
</style>

<form autocomplete="off" onsubmit="return false;" action="{:request()->url()}" data-auto="true" method="post" class='form-horizontal layui-form padding-top-20'>
    <legend>基本信息</legend>
    <div class="form-group">
        <label class="col-sm-2 control-label">优惠券名称</label>
        <div class='col-sm-8'>
            <input autofocus name="coupon_name" value='{$vo.coupon_name|default=""}' required="required" title="请输入优惠券名称" placeholder="请输入优惠券名称" class="layui-input">
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label label-required" data-coupon-type="1">
            优惠金额
        </label>
        <div class="col-sm-8">
            <input name="coupon_quota" type="number"  value='{$vo.coupon_quota|default=""}' required="required" title="请输入金额" placeholder="请输入金额" class="layui-input">
            <p class="help-block">请输入优惠券金额</p>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label">
            使用门槛
        </label>
        <div class="col-sm-8">
            <input name="use_threshold" type="number" value='{$vo.use_threshold|default=""}' required="required" title="请输入使用限制" placeholder="请输入金额" class="layui-input">
            <p class="help-block">填写满多少金额可以使用，不填或填写0为不限制。</p>
        </div>
    </div>
    <!--<legend>基本规则</legend>
    <div class="form-group">
        <label class="col-sm-2 control-label label-required">
            有效期
        </label>
        <div class="col-sm-8">
            {foreach [1=>'固定日期',2=>'动态日期'] as $k=>$v}
            <label class="think-radio">
                &lt;!&ndash;{eq name="k" value="$vo.time_type|default='1'"}&ndash;&gt;
                <input checked type="radio" name="time_type" value="{$k}" title="{$v}" lay-ignore>
                &lt;!&ndash;{else}&ndash;&gt;
                <input type="radio" name="time_type" value="{$k}" title="{$v}" lay-ignore>
                &lt;!&ndash;{/eq}&ndash;&gt;
                {$v}
            </label>
            {/foreach}
        </div>
    </div>-->
    <!--<div class="form-group" data-time-type="1">
        <label class="col-sm-2 control-label"></label>
        <div class='col-sm-8'>
            <input name="coupon_time" id="coupon_time" required value="{$vo.coupon_time|default=''}" placeholder="请选择有效期" class="layui-input">
            <p class="help-block">在固定日期范围内有效</p>
        </div>
    </div>-->
    <!--<div class="form-group" data-time-type="2">
        <label class="col-sm-2 control-label"></label>
        <div class='col-sm-8'>
            <input type="number" required name="coupon_day" value='{$vo.coupon_day|default=""}'  title="请输入天数" placeholder="请输入天数" class="layui-input">
            <p class="help-block">自领券当日开始N天内有效</p>
        </div>
    </div>-->
    <!--<div class="form-group">
        <label class="col-sm-2 control-label label-required">
            使用范围
        </label>
        <div class="col-sm-8">
            {foreach [1=>'通用',2=>'指定商品分类',4=>'指定商品'] as $k=>$v}&lt;!&ndash;,3=>'指定商品品牌'&ndash;&gt;
            <label class="think-radio">
                &lt;!&ndash;{eq name="k" value="$vo.coupon_auth_type|default='1'"}&ndash;&gt;
                <input checked type="radio" name="coupon_auth_type" value="{$k}" title="{$v}" lay-ignore>
                &lt;!&ndash;{else}&ndash;&gt;
                <input type="radio" name="coupon_auth_type" value="{$k}" title="{$v}" lay-ignore>
                &lt;!&ndash;{/eq}&ndash;&gt;
                {$v}
            </label>
            {/foreach}
        </div>
    </div>-->
    <!--{if isset($cates)}-->
    <!--<div class="form-group" data-auth-type="2">
        <label class="col-sm-2 control-label label-required">商品分类</label>
        <div class='col-sm-8 text-top'>
            &lt;!&ndash;{if !empty($cates)}&ndash;&gt;
            <select required class="layui-select full-width" name="coupon_auth_cate" lay-search>
                {foreach $cates as $cate}
                &lt;!&ndash;{if isset($vo.coupon_auth_cate) and $cate.id eq $vo.coupon_auth_cate}&ndash;&gt;
                <option selected value="{$cate.id}">{$cate.spl|raw}{$cate.cate_title}</option>
                &lt;!&ndash;{else}&ndash;&gt;
                <option value="{$cate.id}">{$cate.spl|raw}{$cate.cate_title}</option>
                &lt;!&ndash;{/if}&ndash;&gt;
                {/foreach}
            </select>
            &lt;!&ndash;{else}&ndash;&gt;
            <span class="color-desc" style="line-height:36px">未配置商品分类</span>
            &lt;!&ndash;{/if}&ndash;&gt;
        </div>
    </div>-->
    <!--{/if}-->
    <!--{if isset($brands)}-->
    <!--<div class="form-group" data-auth-type="3">
        <label class="col-sm-2 control-label label-required">商品品牌</label>
        <div class='col-sm-8'>
            &lt;!&ndash;{if !empty($brands)}&ndash;&gt;
            <select required class="layui-select full-width" name="coupon_auth_brand" lay-search>
                {foreach $brands as $brand}
                &lt;!&ndash;{if isset($vo.coupon_auth_brand) and $brand.id eq $vo.coupon_auth_brand}&ndash;&gt;
                <option selected="selected" value="{$brand.id}">{$brand.brand_title}</option>
                &lt;!&ndash;{else}&ndash;&gt;
                <option value="{$brand.id}">{$brand.brand_title}</option>
                &lt;!&ndash;{/if}&ndash;&gt;
                {/foreach}
            </select>
            &lt;!&ndash;{else}&ndash;&gt;
            <span class="color-desc" style="line-height:36px">未配置商品品牌</span>
            &lt;!&ndash;{/if}&ndash;&gt;
        </div>
    </div>-->
    <!--{/if}-->
    <!--{if isset($goods)}-->
    <!--<div class="form-group" data-auth-type="4">
        <label class="col-sm-2 control-label label-required">选择商品</label>
        <div class='col-sm-8'>
            &lt;!&ndash;{if !empty($goods)}&ndash;&gt;
            <select required class="layui-select full-width" name="coupon_auth_goods" lay-search>
                {foreach $goods as $good}
                &lt;!&ndash;{if isset($vo.coupon_auth_goods) and $good.id eq $vo.coupon_auth_goods}&ndash;&gt;
                <option selected="selected" value="{$good.id}">{$good.goods_title}</option>
                &lt;!&ndash;{else}&ndash;&gt;
                <option value="{$good.id}">{$good.goods_title}</option>
                &lt;!&ndash;{/if}&ndash;&gt;
                {/foreach}
            </select>
            &lt;!&ndash;{else}&ndash;&gt;
            <span class="color-desc" style="line-height:36px">未添加商品</span>
            &lt;!&ndash;{/if}&ndash;&gt;
        </div>
    </div>-->
    <!--{/if}-->

    <div class="hr-line-dashed"></div>

    <div class="col-sm-7 col-sm-offset-2">
        <div class="layui-form-item text-center">
            <input type="hidden" name="uid" value="{$uid}">
            <button class="layui-btn" type="submit">立即赠送</button>
        </div>
    </div>

    <script>window.form.render();window.laydate.render({range: true, elem: '#coupon_time'});</script>

    <style>
        .background-item {
            padding: 15px;
            background: #efefef;
        }

        .background-item thead tr {
            background: #e0e0e0
        }
    </style>
</form>
<script>
    (function () {

        <!-- 优惠形式-->
        buildForm("data-coupon-type","{$vo.coupon_type|default='1'}");
        $('[name=coupon_type]').on('click', function () {
            buildForm("data-coupon-type",$('[name=coupon_type]:checked').val())
        });
        <!-- 有效期模式-->
        buildForm("data-time-type","{$vo.time_type|default='1'}");
        $('[name=time_type]').on('click', function () {
            buildForm("data-time-type",$('[name=time_type]:checked').val())
        });
        <!-- 使用范围-->
        buildForm("data-auth-type","{$vo.coupon_auth_type|default='1'}");
        $('[name=coupon_auth_type]').on('click', function () {
            buildForm("data-auth-type",$('[name=coupon_auth_type]:checked').val())
        });
        <!-- 等级限制-->
        buildForm("data-level-limits-type","{$vo.level_limits|default='0'}");
        $('[name=level_limits]').on('click', function () {
            buildForm("data-level-limits-type",$('[name=level_limits]:checked').val())
        });
        // 表单显示编译
        function buildForm(obj,value) {
            let $tips = $("[" + obj + "='" + value + "']");
            $("[" + obj + "]").not($tips.show()).hide();
        }
    })();
</script>