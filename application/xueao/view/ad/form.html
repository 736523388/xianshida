{extend name='admin@public/content'}

{block name="content"}
<form autocomplete="off" onsubmit="return false;" action="{:request()->url()}" data-auto="true" method="post" class='form-horizontal layui-form padding-top-20'>

    <div class="form-group">
        <label class="col-sm-2 control-label">广告名称</label>
        <div class='col-sm-8'>
            <input autofocus name="name" value='{$vo.name|default=""}' required="required" title="请输入广告名称" placeholder="请输入广告名称" class="layui-input">
        </div>
    </div>

    <!--{if !empty($cates)}-->
    <div class="form-group">
        <label class="col-sm-2 control-label">广告分类</label>
        <div class='col-sm-8'>
            <select required class="layui-select full-width" name="type">
                {foreach $cates as $cate}
                <!--{eq name='$cate.id' value='$vo.type|default=0'}-->
                <option selected="selected" value="{$cate.id}">{$cate.title}</option>
                <!--{else}-->
                <option value="{$cate.id}">{$cate.title}</option>
                <!--{/eq}-->
                {/foreach}
            </select>
        </div>
    </div>
    <!--{/if}-->

    <div class="form-group">
        <label class="col-sm-2 control-label">跳转目标</label>
        <div class='col-sm-8'>
            <select required class="layui-select full-width" name="target">
                {assign name="target" value="$vo.target|default=''" /}
                <option {$target=='_parent'?'selected':''} value="_parent">父窗口</option>
                <option {$target=='_blank'?'selected':''} value="_blank">新窗口</option>
            </select>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label">展示对象</label>
        <div class='col-sm-8'>
            <select required class="layui-select full-width" name="identity">
                {assign name="identity" value="$vo.identity|default=''" /}
                <option {$identity=='0'?'selected':''} value="0">不限</option>
                <option {$identity=='1'?'selected':''} value="1">会员</option>
                <option {$identity=='2'?'selected':''} value="2">批发商</option>
            </select>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label label-required">图片</label>
        <div class='col-sm-8'>
            <table class="layui-table background-item margin-none" lay-size="sm" lay-skin="nob">
                <thead>
                <tr>
                    <td>广告图片</td>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td class="text-top" style="width:100px">
                        <input type="hidden" name="image" value="{$vo.image|default=''}">
                        <script>$('[name=image]').uploadOneImage()</script>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label">链接类型</label>
        <div class='col-sm-8'>
            {foreach ['1'=>'链接到商品','2' => '链接到地址'] as $k=>$v}
            <input type="radio" name="target_type" value="{$k}" {:isset($vo['target_type'])&&$vo['target_type']==$k?'checked':''} title="{$v}" lay-filter="data-ad-type"/>
            {/foreach}
        </div>
    </div>

    <div>
        <!--<div data-ad-type="0" class="form-group">
            <label class="col-sm-2 control-label">选择商品</label>
            <div class='col-sm-8'>
                {notempty name='goods_list'}
                <select name="goods_id" class="layui-select full-width resource-goods" required lay-search >
                    {foreach $goods_list as $goods}
                    {if isset($vo.url) && $vo.url == $goods.id}
                    <option value="{$goods.id}" selected>{$goods.id} - {$goods.title}</option>
                    {else/}
                    <option value="{$goods.id}">{$goods.id} - {$goods.title}</option>
                    {/if}
                    {/foreach}
                </select>
                {/notempty}
            </div>
        </div>-->

        <div data-ad-type="1" class="form-group">
            <label class="col-sm-2 control-label">广告目标</label>
            <div class='col-sm-8'>
                <input name="url" value='{$vo.url|default=""}'  title="请输入广告目标" placeholder="请输入广告目标" class="layui-input">
            </div>
        </div>
    </div>


    <div class="form-group">
        <label class="col-sm-2 control-label">排序</label>
        <div class='col-sm-8'>
            <input name="sort" value='{$vo.sort|default="0"}'  title="请输入排序值" placeholder="请输入排序值" class="layui-input">
        </div>
    </div>

    <div class="form-group">
        <label class="col-sm-2 control-label">备注</label>
        <div class='col-sm-8'>
            <textarea placeholder="请输入描述" title="请输入描述" class="layui-textarea" name="remark">{$vo.remark|default=""}</textarea>
        </div>
    </div>

    <div class="hr-line-dashed"></div>

    <div class="col-sm-7 col-sm-offset-2">
        <div class="layui-form-item text-center">
            {if !empty($vo.id)}<input type="hidden" name="id" value="{$vo.id}">{/if}
            <button class="layui-btn" type="submit">保存</button>
            <button class="layui-btn layui-btn-danger" type='button' onclick="window.history.back()">取消</button>
        </div>
    </div>

    <script>
    $(function () {
        window.form.render();
        this.target_type = "{$vo.target_type|default=''}" || '0';
        /*form.val('ad', {target_type: this.target_type});*/
        form.on('radio(data-ad-type)', function (data) {
            apply(data.value);
        });
        apply.call(this, this.target_type);

        function apply(type) {
            $('[data-ad-type="' + type + '"]').show().siblings('[data-ad-type]').hide();
        }
    })
    </script>

    <style>
        .background-item {
            padding: 15px;
            background: #efefef;
        }

        .background-item thead tr {
            background: #e0e0e0
        }
    </style>
</form>
{/block}